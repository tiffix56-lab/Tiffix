### Order Management API Testing

@baseURL = https://app.tiffix.com/api/v1
@userToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2OTI2ZTgyM2QxZjlkOWQzMzY1ZmFkYTQiLCJlbWFpbCI6ImhhcnNoZ3VwdGExMDExMEBnbWFpbC5jb20iLCJ1c2VyVHlwZSI6InVzZXIiLCJyb2xlIjoidXNlciIsImlhdCI6MTc2NjAzNDI5OCwiZXhwIjoxNzY2MTIwNjk4fQ.zy_DxCzNdooGQCv7d59Lmaexc8VsBiglYBcgl1rsycE
@vendorToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2ODkyNTRiNjcwMTU1MzVkODE0MmQ2MWIiLCJlbWFpbCI6InNwaWNlLnJlc3RhdXJhbnRAZXhhbXBsZS5jb20iLCJ1c2VyVHlwZSI6InZlbmRvciIsInJvbGUiOiJ2ZW5kb3IiLCJpYXQiOjE3NTY1ODMyMTksImV4cCI6MTc1NjY2OTYxOX0.iPg6M4lXOEVQOzNmCSJ6Lov6s_FCSt8F-utAbdGYKHY
@adminToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2ODk2MzBkYjI3Y2I3OWM0YTFiMzJjM2UiLCJlbWFpbCI6ImFkbWluQGdtYWlsLmNvbSIsInVzZXJUeXBlIjoiYWRtaW4iLCJyb2xlIjoiYWRtaW4iLCJpYXQiOjE3NTY4MTEyMDQsImV4cCI6MTc1Njg5NzYwNH0.XCfF4bgA0hXVAwwhummqak4vkh_ZWpTE3_mDaKoHkR4
@orderId = 68b35970a24e266b6f31e31d

############### USER ORDER MANAGEMENT ###############

### Get User's Orders (All)
GET {{baseURL}}/my-orders
Authorization: Bearer {{userToken}}

### Get User's Orders with Status Filter
GET {{baseURL}}/my-orders?status=upcoming&page=1&limit=10
Authorization: Bearer {{userToken}}

### Get User's Orders with Search
GET {{baseURL}}/my-orders?search=pizza&page=1&limit=10
Authorization: Bearer {{userToken}}

### Get User's Orders by Date Range
GET {{baseURL}}/my-orders?startDate=2025-12-17&endDate=2025-12-19
Authorization: Bearer {{userToken}}

### Get User's Orders for Next 7 Days
GET {{baseURL}}/my-orders?days=7
Authorization: Bearer {{userToken}}

### Get User's Delivered Orders
GET {{baseURL}}/my-orders?status=delivered&page=1&limit=20
Authorization: Bearer {{userToken}}

### Get Specific Order Details
GET {{baseURL}}/orders/{{orderId}}
Authorization: Bearer {{userToken}}

### Skip Order (Must be 2+ hours before delivery)
POST {{baseURL}}/orders/{{orderId}}/skip
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "skipReason": "Not feeling well today, will skip lunch"
}

### Cancel Order (Must be 2+ hours before delivery) 
POST {{baseURL}}/orders/{{orderId}}/cancel
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "cancelReason": "Emergency came up, cannot receive delivery"
}

############### VENDOR ORDER MANAGEMENT ###############

### Get Vendor's Orders
GET {{baseURL}}/vendor/orders
Authorization: Bearer {{vendorToken}}

### Get Vendor's Orders with Status Filter
GET {{baseURL}}/vendor/orders?status=upcoming&page=1&limit=10
Authorization: Bearer {{vendorToken}}

### Get Vendor's Orders with Search
GET {{baseURL}}/vendor/orders?search=John&page=1&limit=10
Authorization: Bearer {{vendorToken}}

### Get Vendor's Orders for Today
GET {{baseURL}}/vendor/orders?days=1
Authorization: Bearer {{vendorToken}}

### Get Vendor's Orders by Date Range
GET {{baseURL}}/vendor/orders?startDate=2024-01-15&endDate=2024-01-15
Authorization: Bearer {{vendorToken}}

### Update Order Status to Preparing
PATCH {{baseURL}}/orders/{{orderId}}/status
Content-Type: application/json
Authorization: Bearer {{vendorToken}}

{
  "status": "preparing",
  "notes": "Started preparing the meal"
}

### Update Order Status to Out for Delivery
PATCH {{baseURL}}/orders/{{orderId}}/status
Content-Type: application/json
Authorization: Bearer {{vendorToken}}

{
  "status": "out_for_delivery", 
  "notes": "Order is out for delivery"
}

### Try to Set Order as Delivered (Should Fail - Vendor Restriction)
PATCH {{baseURL}}/orders/{{orderId}}/status
Content-Type: application/json
Authorization: Bearer {{vendorToken}}

{
  "status": "delivered",
  "notes": "This should fail - vendors cannot mark as delivered"
}

############### ADMIN ORDER MANAGEMENT ###############

### Get All Orders (Admin View)
GET {{baseURL}}/admin/orders
Authorization: Bearer {{adminToken}}

### Get Orders with Filters
GET {{baseURL}}/admin/orders?status=out_for_delivery&page=1&limit=10
Authorization: Bearer {{adminToken}}

### Get Orders with Search
GET {{baseURL}}/admin/orders?search=a&page=1&limit=10
Authorization: Bearer {{adminToken}}

### Get Orders by Vendor
GET {{baseURL}}/admin/orders?vendorId=674c8e5b123456789012345b
Authorization: Bearer {{adminToken}}

### Get Orders by Date Range
GET {{baseURL}}/admin/orders?startDate=2024-01-01&endDate=2024-01-31
Authorization: Bearer {{adminToken}}

### Confirm Order Delivery (Admin Only)
POST {{baseURL}}/admin/orders/{{orderId}}/confirm-delivery
Content-Type: application/json
Authorization: Bearer {{adminToken}}

{
  "notes": "Delivery confirmed by admin",
  "photos": ["https://delivery-photo-1.jpg", "https://delivery-photo-2.jpg"]
}

############### ORDER SEARCH EXAMPLES ###############

### Search User Orders by Order Number
GET {{baseURL}}/my-orders?search=ORD123456&page=1&limit=10
Authorization: Bearer {{userToken}}

### Search User Orders by Menu/Food Title
GET {{baseURL}}/my-orders?search=biryani&page=1&limit=10
Authorization: Bearer {{userToken}}

### Search User Orders by Vendor Business Name
GET {{baseURL}}/my-orders?search=spice%20restaurant&page=1&limit=10
Authorization: Bearer {{userToken}}

### Search User Orders by Special Instructions
GET {{baseURL}}/my-orders?search=extra%20spicy&page=1&limit=10
Authorization: Bearer {{userToken}}

### Search Vendor Orders by Customer Name
GET {{baseURL}}/vendor/orders?search=John%20Doe&page=1&limit=10
Authorization: Bearer {{vendorToken}}

### Search Vendor Orders by Order Number
GET {{baseURL}}/vendor/orders?search=ORD789&page=1&limit=10
Authorization: Bearer {{vendorToken}}

### Search Vendor Orders by Food Title
GET {{baseURL}}/vendor/orders?search=chicken%20curry&page=1&limit=10
Authorization: Bearer {{vendorToken}}

### Admin Search by Order Number
GET {{baseURL}}/admin/orders?search=ORD2024&page=1&limit=10
Authorization: Bearer {{adminToken}}

### Admin Search by Customer Name
GET {{baseURL}}/admin/orders?search=Alice&page=1&limit=10
Authorization: Bearer {{adminToken}}

### Admin Search by Customer Email
GET {{baseURL}}/admin/orders?search=customer@example.com&page=1&limit=10
Authorization: Bearer {{adminToken}}

### Admin Search by Vendor Business Name
GET {{baseURL}}/admin/orders?search=Pizza%20Palace&page=1&limit=10
Authorization: Bearer {{adminToken}}

### Admin Search by Skip Reason
GET {{baseURL}}/admin/orders?search=feeling%20sick&page=1&limit=10
Authorization: Bearer {{adminToken}}

### Admin Search by Cancel Reason
GET {{baseURL}}/admin/orders?search=emergency&page=1&limit=10
Authorization: Bearer {{adminToken}}

### Admin Search by Delivery Notes
GET {{baseURL}}/admin/orders?search=left%20at%20door&page=1&limit=10
Authorization: Bearer {{adminToken}}

### Combined Search with Filters
GET {{baseURL}}/admin/orders?search=late%20delivery&status=delivered&page=1&limit=10
Authorization: Bearer {{adminToken}}
